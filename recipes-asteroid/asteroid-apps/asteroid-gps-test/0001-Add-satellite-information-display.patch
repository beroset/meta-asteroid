From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: AsteroidOS <dev@asteroidos.org>
Date: Fri, 31 Jan 2026 19:00:00 +0000
Subject: [PATCH] Add satellite information display

Add SatelliteSource to display satellite information (used/visible count).
This demonstrates proper usage of SatelliteSource which requires
QtPositioning 5.14 or higher.

Also adds DisplayBlanking from Nemo.KeepAlive to prevent screen blanking
during GPS testing.
---
 src/main.qml | 100 ++++++++++++++++++++++++++++++++++++++++++++++-----
 1 file changed, 91 insertions(+), 9 deletions(-)

diff --git a/src/main.qml b/src/main.qml
index 1111111..2222222 100644
--- a/src/main.qml
+++ b/src/main.qml
@@ -16,31 +16,113 @@
  */
 
 import QtQuick 2.9
-import QtPositioning 5.2
+import QtPositioning 5.15
+import Nemo.KeepAlive 1.1
 import org.asteroid.controls 1.0
 
 Application {
     id: app
 
     centerColor: "#b04d1c"
-    outerColor: "#421c0a"
+    outerColor: "#621c0a"
 
-    Label {
-        id: positionText
-        anchors.centerIn: parent
-        horizontalAlignment: Text.AlignHCenter
+    Column {
+        anchors.fill: parent
+        spacing: 2
+
+        Label {
+            height: parent.height * 0.2
+            width: parent.width
+            text: src.name
+            horizontalAlignment: Text.AlignHCenter
+            verticalAlignment: Text.AlignVCenter
+        }
+
+        Label {
+            height: parent.height * 0.2
+            width: parent.width
+            text: src.valid ? "valid" : "not valid"
+            horizontalAlignment: Text.AlignHCenter
+            verticalAlignment: Text.AlignVCenter
+        }
+
+        Label {
+            id: latitude
+            height: 30
+            width: parent.width
+            text: "no latitude"
+            horizontalAlignment: Text.AlignHCenter
+            verticalAlignment: Text.AlignVCenter
+        }
+
+        Label {
+            id: longitude
+            height: 30
+            width: parent.width
+            text: "no longitude"
+            horizontalAlignment: Text.AlignHCenter
+            verticalAlignment: Text.AlignVCenter
+        }
+
+        Label {
+            id: timestamp
+            height: parent.height / 4
+            width: parent.width
+            text: "no timestamp"
+            horizontalAlignment: Text.AlignHCenter
+            verticalAlignment: Text.AlignVCenter
+        }
+
+        Label {
+            id: satinfo
+            height: 30
+            width: parent.width
+            text: "used: 0  vis: 0"
+            horizontalAlignment: Text.AlignHCenter
+            verticalAlignment: Text.AlignVCenter
+        }
     }
 
+    /*
+     * Position fixes
+     */
     PositionSource {
         id: src
         updateInterval: 1000
-        active: true
+        active: false
         preferredPositioningMethods: PositionSource.SatellitePositioningMethods
 
         onPositionChanged: {
-            var coord = src.position.coordinate;
-            positionText.text = "Coordinate:\n" + coord.longitude + " - " + coord.latitude;
+            var coord = position.coordinate
+            latitude.text = coord.latitude.toFixed(6)
+            longitude.text = coord.longitude.toFixed(6)
+            if (position.timestamp)
+                timestamp.text = position.timestamp.toString()
+        }
+    }
+
+    /*
+     * Satellite information (used / visible)
+     */
+    SatelliteSource {
+        id: sats
+        active: false
+
+        onSatellitesInUseChanged: updateSatInfo()
+        onSatellitesInViewChanged: updateSatInfo()
+
+        function updateSatInfo() {
+            satinfo.text =
+                "used: " + satellitesInUse.length +
+                "  vis: " + satellitesInView.length
         }
     }
+
+    Component.onCompleted: {
+        DisplayBlanking.preventBlanking = true
+        src.active = true
+        sats.active = true
+    }
 }
+
-- 
2.34.1
